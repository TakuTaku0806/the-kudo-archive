<div class="container mx-auto px-4 py-8 flex flex-col lg:flex-row gap-8">
  <!-- Main content -->
  <div class="lg:w-3/4">
    <h1 class="text-3xl font-bold mb-4"><%= @post.title %></h1>
     <% if current_user&.admin? %>
    <div class="flex gap-2 mt-4">  
        <%= link_to "Edit", edit_post_path(@post), class: "bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700" %>
        <%= link_to "Delete", @post,
            data: { turbo_method: :delete, turbo_confirm: "Are you sure?" },
            class: "bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700" %>
    </div>
  <% end %>      
    <div class="prose max-w-none">
      <%= raw add_ids_to_headings(@post.content) %>
    </div>

    <!-- Comments -->
    <div class="mt-12 border-t pt-8">
      <h2 class="text-2xl font-bold mb-4">Comments</h2>
      <% if @post.comments.any? %>
        <div class="space-y-4">
          <%= render @post.comments %>
        </div>
      <% else %>
        <p class="text-gray-500">It's a bit quiet here.</p>
      <% end %>

      <% if user_signed_in? %>
        <div class="mt-8">
          <h3 class="text-lg font-semibold mb-2">Add a comment</h3>
          <%= form_with model: [@post, Comment.new], local: true, class: "space-y-4" do |f| %>
            <div>
              <%= f.text_area :content, rows: 4, class: "w-full border rounded-lg p-2", placeholder: "Your comment..." %>
            </div>
            <%= f.submit "Publish", class: "bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700" %>
          <% end %>
        </div>
      <% else %>
        <p class="mt-4"><%= link_to "Sign In", new_user_session_path, class: "text-indigo-600 hover:underline" %> to comment</p>
      <% end %>
    </div>
  </div>

  <!-- ToC -->
  <aside class="lg:w-1/4">
    <div class="sticky top-4 bg-gray-50 p-4 rounded-lg" data-controller="smooth-scroll">
      <h3 class="font-semibold text-lg mb-3">On this page</h3>
      <%= toc_from_content(@post.content) %>
    </div>
  </aside>
</div>